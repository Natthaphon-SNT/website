<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E.need pc - จัดสเปคคอมออนไลน์</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap');
        body { 
            font-family: 'Kanit', sans-serif; 
            margin: 0;
            background-color: #020617; /* ใส่สีพื้นหลังไว้ก่อนกันหน้าขาว */
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // แก้ไขการดึง Icon ให้ปลอดภัยขึ้น
        const { 
            ShoppingCart, Cpu, Monitor, HardDrive, Box, Zap, CreditCard, 
            CheckCircle, X, Menu, Trash2, Plus, Smartphone, Server, 
            Fan, CircuitBoard, AlertTriangle, RotateCcw, Save 
        } = typeof lucide !== 'undefined' ? lucide : {};

        // --- ข้อมูลสินค้า (ยกมาเหมือนเดิม) ---
        const CATEGORIES = [
            { id: 'cpu', name: 'CPU', icon: <Cpu /> },
            { id: 'motherboard', name: 'Mainboard', icon: <CircuitBoard /> },
            { id: 'gpu', name: 'VGA', icon: <Monitor /> },
            { id: 'ram', name: 'RAM', icon: <Server /> },
            { id: 'storage', name: 'Storage', icon: <HardDrive /> },
            { id: 'psu', name: 'Power Supply', icon: <Zap /> },
            { id: 'case', name: 'Case', icon: <Box /> },
            { id: 'cooler', name: 'Cooling', icon: <Fan /> },
        ];

        const PRODUCTS = {
            cpu: [
                { id: 'c1', name: 'Intel Core i9-14900K', price: 24500, detail: 'LGA1700, 24C/32T', socket: 'LGA1700', power: 253 },
                { id: 'c2', name: 'Intel Core i5-14600K', price: 12900, detail: 'LGA1700, 14C/20T', socket: 'LGA1700', power: 181 },
                { id: 'c3', name: 'AMD Ryzen 9 7950X3D', price: 26900, detail: 'AM5, 16C/32T', socket: 'AM5', power: 120 },
                { id: 'c4', name: 'AMD Ryzen 5 7600X', price: 8500, detail: 'AM5, 6C/12T', socket: 'AM5', power: 105 },
            ],
            motherboard: [
                { id: 'm1', name: 'ASUS ROG MAXIMUS Z790', price: 22900, detail: 'LGA1700, DDR5, WiFi 6E', socket: 'LGA1700', ramType: 'DDR5' },
                { id: 'm2', name: 'MSI MAG B760 TOMAHAWK', price: 7590, detail: 'LGA1700, DDR5, WiFi 6', socket: 'LGA1700', ramType: 'DDR5' },
                { id: 'm3', name: 'GIGABYTE X670E AORUS', price: 18500, detail: 'AM5, DDR5, PCIe 5.0', socket: 'AM5', ramType: 'DDR5' },
                { id: 'm4', name: 'ASUS PRIME B660M-K', price: 3590, detail: 'LGA1700, DDR4', socket: 'LGA1700', ramType: 'DDR4' },
            ],
            gpu: [
                { id: 'g1', name: 'NVIDIA RTX 4090 24GB', price: 72000, detail: '24GB GDDR6X', power: 450 },
                { id: 'g2', name: 'NVIDIA RTX 4070 Ti 12GB', price: 32500, detail: '12GB GDDR6X', power: 285 },
                { id: 'g3', name: 'AMD Radeon RX 7900 XTX', price: 39900, detail: '24GB GDDR6', power: 355 },
                { id: 'g4', name: 'NVIDIA RTX 4060 8GB', price: 11500, detail: '8GB GDDR6', power: 115 },
            ],
            ram: [
                { id: 'r1', name: 'Corsair Vengeance RGB 32GB', price: 5900, detail: 'DDR5 6000MHz', type: 'DDR5' },
                { id: 'r2', name: 'G.SKILL Trident Z5 32GB', price: 6500, detail: 'DDR5 6400MHz', type: 'DDR5' },
                { id: 'r3', name: 'Kingston Fury Beast 16GB', price: 2500, detail: 'DDR4 3200MHz', type: 'DDR4' },
            ],
            storage: [
                { id: 's1', name: 'Samsung 990 PRO 1TB', price: 4590, detail: 'M.2 NVMe Gen4', power: 10 },
                { id: 's2', name: 'WD Black SN850X 2TB', price: 6900, detail: 'M.2 NVMe Gen4', power: 10 },
                { id: 's3', name: 'Kingston NV2 1TB', price: 2190, detail: 'M.2 NVMe Gen4', power: 5 },
            ],
            psu: [
                { id: 'p1', name: 'Corsair RM850e 850W', price: 4790, detail: '80+ Gold, 850W', watts: 850 },
                { id: 'p2', name: 'Thermaltake Toughpower 1000W', price: 6590, detail: '80+ Gold, 1000W', watts: 1000 },
                { id: 'p3', name: 'SilverStone 650W', price: 1990, detail: '80+ Bronze, 650W', watts: 650 },
            ],
            case: [
                { id: 'ca1', name: 'NZXT H9 Flow', price: 5990, detail: 'Dual Chamber, Panoramic Glass' },
                { id: 'ca2', name: 'Lian Li O11 Dynamic', price: 4990, detail: 'Classic Showcase Case' },
                { id: 'ca3', name: 'Montech Air 100', price: 1690, detail: 'Micro-ATX, High Airflow' },
            ],
            cooler: [
                { id: 'co1', name: 'NZXT Kraken Elite 360', price: 9900, detail: 'AIO Liquid Cooler', power: 15 },
                { id: 'co2', name: 'Deepcool AK620 Digital', price: 2990, detail: 'Air Cooler', power: 10 },
                { id: 'co3', name: 'Stock Cooler', price: 0, detail: 'Standard', power: 5 },
            ]
        };

        const formatPrice = (num) => num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

        function App() {
            const [currentView, setCurrentView] = React.useState('builder');
            const [selectedParts, setSelectedParts] = React.useState({});
            const [activeCategory, setActiveCategory] = React.useState('cpu');
            const [totalPrice, setTotalPrice] = React.useState(0);

            React.useEffect(() => {
                let total = 0;
                Object.values(selectedParts).forEach(part => { if (part) total += part.price; });
                setTotalPrice(total);
            }, [selectedParts]);

            const handleSelectProduct = (category, product) => {
                setSelectedParts(prev => ({ ...prev, [category]: product }));
            };

            return (
                <div className="min-h-screen bg-slate-950 text-slate-200">
                    <header className="bg-slate-900 border-b border-slate-700 p-4 sticky top-0 z-50">
                        <div className="max-w-7xl mx-auto flex justify-between items-center">
                            <div className="flex items-center gap-2">
                                {Monitor && <Monitor className="text-cyan-400" />}
                                <span className="text-2xl font-bold bg-gradient-to-r from-cyan-400 to-purple-500 text-transparent bg-clip-text">E.need pc</span>
                            </div>
                            <div className="cursor-pointer" onClick={() => Object.keys(selectedParts).length > 0 && setCurrentView('cart')}>
                                {ShoppingCart && <ShoppingCart className={Object.keys(selectedParts).length > 0 ? "text-white" : "text-slate-500"} />}
                            </div>
                        </div>
                    </header>

                    <main className="max-w-7xl mx-auto px-4 py-8">
                        {currentView === 'builder' ? (
                            <div className="grid grid-cols-1 lg:grid-cols-4 gap-6">
                                <div className="space-y-2">
                                    {CATEGORIES.map(cat => (
                                        <button 
                                            key={cat.id}
                                            onClick={() => setActiveCategory(cat.id)}
                                            className={`w-full flex items-center p-3 rounded-lg border transition-all ${activeCategory === cat.id ? 'bg-cyan-600/20 border-cyan-500' : 'bg-slate-800 border-transparent'}`}
                                        >
                                            <span className="mr-3">{cat.icon}</span>
                                            {cat.name}
                                        </button>
                                    ))}
                                </div>
                                <div className="lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {PRODUCTS[activeCategory]?.map(product => (
                                        <div 
                                            key={product.id}
                                            onClick={() => handleSelectProduct(activeCategory, product)}
                                            className={`p-4 rounded-xl border cursor-pointer ${selectedParts[activeCategory]?.id === product.id ? 'border-cyan-500 bg-slate-800' : 'border-slate-700 bg-slate-900/50'}`}
                                        >
                                            <div className="flex justify-between font-bold text-cyan-400">
                                                <span>{product.name}</span>
                                                <span>฿{formatPrice(product.price)}</span>
                                            </div>
                                            <p className="text-xs text-slate-400 mt-2">{product.detail}</p>
                                        </div>
                                    ))}
                                </div>
                                <div className="bg-slate-800 p-6 rounded-xl border border-slate-700 h-fit">
                                    <h2 className="text-xl font-bold mb-4">สรุปราคารวม</h2>
                                    <div className="text-3xl font-bold text-cyan-400 mb-6">฿{formatPrice(totalPrice)}</div>
                                    <button 
                                        onClick={() => setCurrentView('cart')}
                                        disabled={totalPrice === 0}
                                        className="w-full py-3 bg-cyan-600 rounded-lg font-bold disabled:opacity-50"
                                    >
                                        ดูรายละเอียดการสั่งซื้อ
                                    </button>
                                </div>
                            </div>
                        ) : (
                            <div className="max-w-2xl mx-auto bg-slate-800 p-8 rounded-xl border border-slate-700">
                                <h2 className="text-2xl font-bold mb-6">รายการที่คุณเลือก</h2>
                                {Object.entries(selectedParts).map(([key, part]) => (
                                    <div key={key} className="flex justify-between py-2 border-b border-slate-700">
                                        <span className="text-slate-400 uppercase text-xs">{key}</span>
                                        <span>{part.name} - ฿{formatPrice(part.price)}</span>
                                    </div>
                                ))}
                                <button onClick={() => setCurrentView('builder')} className="mt-8 text-cyan-400">← กลับไปเลือกเพิ่ม</button>
                            </div>
                        )}
                    </main>
                </div>
            );
        }

        // เพิ่มการตรวจสอบความปลอดภัยก่อน Render
        try {
            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(<App />);
        } catch (err) {
            console.error("Render error:", err);
            document.getElementById('root').innerHTML = `<div style="color:white; padding:20px;">เกิดข้อผิดพลาด: ${err.message}</div>`;
        }
    </script>
</body>
</html>
